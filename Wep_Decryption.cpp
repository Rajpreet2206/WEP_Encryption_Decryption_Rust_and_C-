
#include<chrono>
#include <iostream>
#include <string>
#include <bitset>
#include <vector>
#include <cstdint>

int countCharacters(const std::string& str) {
    return str.size();
}
template<typename Duration, typename Function, typename... Args>
Duration time_taken_by_the_function(const std::string& function_name, Function&& function, Args&&... args) {
    auto Tstart = std::chrono::high_resolution_clock::now();
    std::forward<Function>(function)(std::forward<Args>(args)...);
    auto Tend = std::chrono::high_resolution_clock::now();
    auto time_duration = std::chrono::duration_cast<Duration>(Tend - Tstart);
    std::cout << "Executing the '" << function_name << "' took " << time_duration.count() << " microseconds" << std::endl;
    return time_duration;
}
std::string wep_decrypt(const std::string& ciphertext, const std::vector<uint8_t>& wep_key) {
    std::string plaintext;
    size_t key_length = wep_key.size();

    // Remove spaces from the binary ciphertext
    std::string binary_ciphertext = "";
    for (char c : ciphertext) {
        if (c != ' ') {
            binary_ciphertext += c;
        }
    }
    // Decrypt each byte from the binary ciphertext
    for (size_t i = 0; i < binary_ciphertext.size(); i += 8) {
        std::string byte_str = binary_ciphertext.substr(i, 8);
        uint8_t encrypted_byte = static_cast<uint8_t>(std::bitset<8>(byte_str).to_ulong());
        char decrypted_byte = encrypted_byte ^ wep_key[i / 8 % key_length];
        plaintext += decrypted_byte;
    }
    return plaintext;
}
int main() {
    std::string ciphertext = "11011101 11011110 11101100 10101101 10011100 11001111 11001000 10101001 10110011 10011010 10001010 11010011 10100011 10101010 11001110 11011110 11010100 11101100 10110001 10001011 11001011 11001001 10100010 11111101 10011100 11001111 11011100 10111110 10111000 10011101 11011001 11010010 10100011 10110011 11001110 11000111 11010100 10101000 10111000 10000010 11011001 10011011 10100011 10110011 11001110 11100110 11010010 10101001 11111101 10001001 11011000 11010100 10111001 10101101 10011101 10100000 11011010 10100010 10111001 11001110 11001011 11001011 10111100 10110001 10010111 10001010 11010100 10111001 10101111 11001110 11001100 11010100 10111110 10110000 10011011 11000110 11011010 10111000 10110100 10000001 11000100 10011011 10111000 10110010 11001110 11011100 11010010 10111111 10101000 10001111 11000110 10011011 10100011 10111111 10000100 11001111 11011000 10111000 11111101 10011010 11011000 11011010 10101111 10110110 10000111 11000100 11011100 11101100 10101001 10001111 11011001 11010000 10111111 11110011 11001110 11100111 11011010 10100010 10100100 11001110 11011110 11001001 10101101 10110011 10011101 11001100 11010100 10111110 10110000 10001111 11011110 11010010 10100011 10110011 10011101 10001010 11001110 10111111 10111000 10001010 10100000 11010010 10100010 11111101 10001101 11000101 11010110 10111100 10101000 10011010 11001111 11001001 11101100 10101011 10000111 11011001 11010010 10100011 10110011 11000010 10001010 11011101 10100011 10101111 11001110 11001111 11000011 10101101 10110000 10011110 11000110 11011110 11101100 10110010 10011100 11011110 11010011 10100011 10111010 10000001 11000100 11011010 10100000 11111101 10001001 11011000 11010100 10111001 10101101 11001110 11001011 11010101 10101000 11111101 10011100 11000101 11001111 10101101 10101001 10000111 11000101 11010101 10111111 11110001 11001110 11000010 11011010 10111010 10111000 11001110 11000111 11011010 10111000 10101111 10000111 11010010 10011011 10000000 10110100 10001011 10100000 11011100 10111110 10110010 10011011 11011010 10011011 10111111 10101001 10011100 11011111 11011000 10111000 10101000 10011100 11001111 10010101 11101100 10001000 10000000 11000110 11010010 10100111 10111000 11001110 11001001 11010100 10100010 10101011 10001011 11000100 11001111 10100101 10110010 10000000 11001011 11010111 11101100 10110000 10001011 11011110 11010011 10100011 10111001 10011101 10001010 11001111 10100100 10111100 10011010 10001010 11001011 10111110 10110010 10001101 11001111 11011110 10101000 11111101 10001100 11010011 10011011 10101000 10110100 10011100 11001111 11011000 10111000 10110001 10010111 10001010 11010111 10100101 10110011 10001011 11001011 11001001 10100101 10100111 10000111 11000100 11011100 11000110 10101001 10000110 11001111 11001000 10101001 11111101 10011010 11011000 11011010 10100010 10101110 10001000 11000101 11001001 10100001 10111100 10011010 11000011 11010100 10100010 10101110 11000010 10001010 11001111 10100100 10101000 10011101 10000110 10011011 10100001 10111100 10000101 11000011 11010101 10101011 11111101 10001111 11000100 10011011 10100101 10110000 10011110 11000110 11010010 10101111 10110100 10011010 10001010 11111110 10111001 10111110 10000010 11000011 11011111 10101001 10111100 10000000 10001010 11001000 10111100 10111100 10001101 11001111 10011011 10101101 10101110 10011101 11011111 11010110 10111100 10101001 10000111 11000101 11010101 11100000 11111101 10011001 11001111 10110001 10101010 10110010 10011100 11000111 11001110 10100000 10111100 10011010 11001111 10011011 10101101 11111101 10011100 11001111 11011100 10111110 10111000 10011101 11011001 11010010 10100011 10110011 11001110 11000111 11010100 10101000 10111000 10000010 10001010 11010100 10100010 11111101 10011010 11000010 11011110 11101100 10111110 10000001 11011000 11001001 10101001 10101110 10011110 11000101 11010101 10101000 10110100 10000000 11001101 10011011 10000000 10110100 10001011 10001010 11011010 10100000 10111010 10001011 11001000 11001001 10101101 11111101 10011010 11000010 11011010 10111000 11111101 10000011 11000011 11010101 10100101 10110000 10000111 11010000 11011110 10111111 11111101 10001111 10001010 11011101 10100101 10101111 10011101 11011110 10110001 10100011 10101111 10001010 11001111 11001001 11101100 10111100 10011110 11011010 11001001 10100011 10100101 10000111 11000111 11011010 10111000 10110100 10000001 11000100 10011011 10111000 10110010 11001110 11011110 11010011 10101001 11111101 10001001 11001111 11010100 10101000 10111000 10011101 11000011 11011000 11101100 10111000 10011100 11011000 11010100 10111110";
    std::vector<uint8_t> wep_key = { 0xAA, 0xBB, 0xCC, 0xDD, 0xEE };
    std::string decrypted_text = wep_decrypt(ciphertext, wep_key);
    int Characters_Count =  countCharacters(ciphertext);
    std::cout << "Number of characters: " << Characters_Count << std::endl;
    std::cout << "Ciphertext (binary): " << ciphertext << std::endl;
    std::cout << "Decrypted Text: " << decrypted_text << std::endl;
    auto duration = time_taken_by_the_function<std::chrono::microseconds>("wep_decrypt", wep_decrypt, ciphertext, wep_key);
    return 0;
}